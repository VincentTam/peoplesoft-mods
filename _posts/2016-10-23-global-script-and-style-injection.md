---
id: 744
title: Global Script and Style Injection
date: 2016-10-23T10:40:20+00:00
guid: https://www.peoplesoftmods.com/?p=744
permalink: /servlet-filters/global-script-and-style-injection/
categories:
  - Servlet Filters
---
Modifying or transforming response data generated by the web server is a great use of servlet filters.  I read a <a href="http://stackoverflow.com/questions/14736328/looking-for-an-example-for-inserting-content-into-the-response-using-a-servlet-f" target="_blank">nice Stack Overflow thread</a> that discusses the idea of injecting text into the head of an HTML response using a servlet filter.  The code provided in this thread is a great example of how to modify HTML response data that gets sent to the client.  I made some slight modifications to this code so that I can inject custom scripts and styles in the HTML responses generated by the PeopleSoft web server.  This servlet filter will be a bolt-on solution to achieve global script and style injection in PeopleSoft.  Below are the steps to configure this servlet filter for the PeopleSoft web server.

<!--more-->

[**CLICK HERE**](https://www.peoplesoftmods.com/Development/PSM_GLOBAL_INJECTION_POC.zip) to download the project.

Extract the zip and you should see the following files:

[<img class="alignnone size-full wp-image-746" src="https://www.peoplesoftmods.com/wp-content/uploads/2016/10/Picture1-1.png" alt="Files" width="544" height="235" srcset="https://www.peoplesoftmods.com/wp-content/uploads/2016/10/Picture1-1.png 544w, https://www.peoplesoftmods.com/wp-content/uploads/2016/10/Picture1-1-300x130.png 300w" sizes="(max-width: 544px) 100vw, 544px" />](https://www.peoplesoftmods.com/wp-content/uploads/2016/10/Picture1-1.png)

Take the folder named “custom” and place it in the following directory:

<pre>%PS_CFG_HOME%\webserv\*your_domain_name*\applications\peoplesoft\PORTAL.war\WEB-INF\classes\com\peoplesoft\pt</pre>

[<img class="alignnone size-full wp-image-747" src="https://www.peoplesoftmods.com/wp-content/uploads/2016/10/Picture2-1.png" alt="Class Files" width="666" height="346" srcset="https://www.peoplesoftmods.com/wp-content/uploads/2016/10/Picture2-1.png 666w, https://www.peoplesoftmods.com/wp-content/uploads/2016/10/Picture2-1-300x156.png 300w" sizes="(max-width: 666px) 100vw, 666px" />](https://www.peoplesoftmods.com/wp-content/uploads/2016/10/Picture2-1.png)

Take the folder named &#8220;psm&#8221; and place it in the following directory:

<pre>%PS_CFG_HOME%\webserv\*your_domain_name*\applications\peoplesoft\PORTAL.war\ps</pre>

[<img class="alignnone size-full wp-image-750" src="https://www.peoplesoftmods.com/wp-content/uploads/2016/10/Picture4-1.png" alt="Scripts and Styles" width="756" height="516" srcset="https://www.peoplesoftmods.com/wp-content/uploads/2016/10/Picture4-1.png 756w, https://www.peoplesoftmods.com/wp-content/uploads/2016/10/Picture4-1-300x205.png 300w, https://www.peoplesoftmods.com/wp-content/uploads/2016/10/Picture4-1-557x380.png 557w" sizes="(max-width: 756px) 100vw, 756px" />](https://www.peoplesoftmods.com/wp-content/uploads/2016/10/Picture4-1.png)

Navigate to and open up the web.xml file.  The web.xml file is located in the following directory:

<pre>%PS_CFG_HOME%\webserv\*your_domain_name*\applications\peoplesoft\PORTAL.war\WEB-INF</pre>

[<img class="alignnone size-full wp-image-751" src="https://www.peoplesoftmods.com/wp-content/uploads/2016/10/Picture3-3.png" alt="web.xml" width="666" height="359" srcset="https://www.peoplesoftmods.com/wp-content/uploads/2016/10/Picture3-3.png 666w, https://www.peoplesoftmods.com/wp-content/uploads/2016/10/Picture3-3-300x162.png 300w" sizes="(max-width: 666px) 100vw, 666px" />](https://www.peoplesoftmods.com/wp-content/uploads/2016/10/Picture3-3.png)

Copy the text from the downloaded file named “webxml.txt” and paste the text into your web.xml file.  Paste in the text so that it is the first <filter> to show up in the web.xml file.  For my environment, I pasted the filter before the delivered “psfilter”.

[<img class="alignnone size-full wp-image-752" src="https://www.peoplesoftmods.com/wp-content/uploads/2016/10/Picture5-1.png" alt="Filter" width="679" height="504" srcset="https://www.peoplesoftmods.com/wp-content/uploads/2016/10/Picture5-1.png 679w, https://www.peoplesoftmods.com/wp-content/uploads/2016/10/Picture5-1-300x223.png 300w, https://www.peoplesoftmods.com/wp-content/uploads/2016/10/Picture5-1-512x380.png 512w" sizes="(max-width: 679px) 100vw, 679px" />](https://www.peoplesoftmods.com/wp-content/uploads/2016/10/Picture5-1.png)

Go to the web profile configuration page in the PIA and select the web profile that you are applying this servlet filter to.  You will need to uncheck the checkbox for the &#8220;Compress Responses&#8221; option.

[<img class="alignnone size-full wp-image-753" src="https://www.peoplesoftmods.com/wp-content/uploads/2016/10/Picture6-1.png" alt="Web Profile" width="763" height="258" srcset="https://www.peoplesoftmods.com/wp-content/uploads/2016/10/Picture6-1.png 763w, https://www.peoplesoftmods.com/wp-content/uploads/2016/10/Picture6-1-300x101.png 300w" sizes="(max-width: 763px) 100vw, 763px" />](https://www.peoplesoftmods.com/wp-content/uploads/2016/10/Picture6-1.png)

**You will need to bounce the web server at this point.**

After bouncing the web server, login to the PIA and navigate around.  You will notice that the script defined in the global.js file gets fired when every page is loaded.

[<img class="alignnone size-full wp-image-754" src="https://www.peoplesoftmods.com/wp-content/uploads/2016/10/Picture7-1.png" alt="Injected Script" width="887" height="374" srcset="https://www.peoplesoftmods.com/wp-content/uploads/2016/10/Picture7-1.png 887w, https://www.peoplesoftmods.com/wp-content/uploads/2016/10/Picture7-1-300x126.png 300w, https://www.peoplesoftmods.com/wp-content/uploads/2016/10/Picture7-1-768x324.png 768w" sizes="(max-width: 887px) 100vw, 887px" />](https://www.peoplesoftmods.com/wp-content/uploads/2016/10/Picture7-1.png)

Any scripts that are defined in the global.js file as well as any styling defined in the global.css file will get injected into every page with the configuration that I have provided.

The servlet filter also has the ability to inject multiple script and style sheets if needed.  The paths to the script files need to be specified as comma separated values for the &#8220;scripts&#8221; param-value in the web.xml file. Similarly, the paths to the style sheets need to be specified as comma separated values for the &#8220;styles&#8221; param-value in the web.xml file.

* * *

The alert script that I defined in the global.js file is not very practical, but it gives you an idea as to when and where the injected script fires.  To enhance this solution, one could write a simple JSP page on the web server that is capable of modifying the files that get injected.  This JSP page can then be consumed through the PIA as an external content reference. That will allow this global script and style injection solution to be configured from within the PeopleSoft application itself.